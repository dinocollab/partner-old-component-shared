{"version":3,"file":"UploadStatus.js","sources":["../../../src/Components/UploadLayout/UploadStatus.tsx"],"sourcesContent":["import { Close, ExpandMore } from '@mui/icons-material'\r\nimport { Box, Card, CardHeader, Typography, IconButton, Accordion, styled, Button } from '@mui/material'\r\nimport React, { Component } from 'react'\r\nimport MuiAccordionSummary, { AccordionSummaryProps } from '@mui/material/AccordionSummary'\r\nimport MuiAccordionDetails from '@mui/material/AccordionDetails'\r\nimport ProgressItem from './ProgressItem'\r\nimport { IUploadLayoutContext, UploadLayoutContext } from '.'\r\n\r\ninterface IUploadStatusProps {\r\n  onUploadClose: React.MouseEventHandler<HTMLButtonElement>\r\n  ContentHeight: number\r\n}\r\ninterface IUploadStatusState {\r\n  expand: boolean\r\n}\r\nexport default class UploadStatus extends Component<IUploadStatusProps, IUploadStatusState> {\r\n  constructor(props: IUploadStatusProps) {\r\n    super(props)\r\n    this.state = {\r\n      expand: true,\r\n    }\r\n  }\r\n  isUnmounted = false\r\n  componentWillUnmount(): void {\r\n    this.isUnmounted = true\r\n  }\r\n  UnCollapse = () => {\r\n    this.setState({ expand: true })\r\n  }\r\n  expanChange = () => {\r\n    this.setState({ expand: !this.state.expand })\r\n  }\r\n  gernerateItems = (context: IUploadLayoutContext) => {\r\n    return context.items.map((item) => {\r\n      return (\r\n        <ProgressItem\r\n          disableDelete={true}\r\n          key={'key' + item.Id}\r\n          item={item}\r\n          {...item}\r\n          onClose={() => context.onItemClose(item)}\r\n          onRetry={() => context.onItemRetry(item)}\r\n        />\r\n      )\r\n    })\r\n  }\r\n\r\n  // setState = <K extends keyof IUploadStatusState>(state: Pick<IUploadStatusState, K> | IUploadStatusState, callback?: () => void) => {\r\n  //     if (this.isUnmounted) return\r\n  //     super.setState(state, callback)\r\n  // }\r\n  componentDidMount(): void {}\r\n\r\n  getErrorTitle = (context: IUploadLayoutContext) => {\r\n    const errors = context.getErrors().length\r\n    const onRetryAll: React.MouseEventHandler<HTMLButtonElement> = (e) => {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      context.onRetryAll()\r\n    }\r\n    return errors ? (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n        <Button onClick={onRetryAll}>Retry all</Button>\r\n        <Typography variant=\"subtitle2\">{context.getErrors().length} error(s)</Typography>\r\n      </Box>\r\n    ) : (\r\n      <></>\r\n    )\r\n  }\r\n  render() {\r\n    return (\r\n      <UploadLayoutContext.Consumer>\r\n        {(context) => {\r\n          return (\r\n            <Card sx={{ flex: 1, background: 'white', margin: '10px', border: '1px solid #e0e0e0' }}>\r\n              <Accordion expanded={this.state.expand} onChange={this.expanChange} sx={{ padding: 0 }}>\r\n                <AccordionSummary expandIcon={<ExpandMore />} sx={{ display: 'flex' }}>\r\n                  <CardHeader\r\n                    action={\r\n                      <IconButton aria-label=\"settings\" onClick={this.props.onUploadClose} sx={{ padding: 0 }}>\r\n                        <Close />\r\n                      </IconButton>\r\n                    }\r\n                    title={\r\n                      <Typography variant=\"subtitle1\" sx={{ fontWeight: 'bold' }}>\r\n                        Upload list ({context.getComplete().length}/{context.items.length})\r\n                      </Typography>\r\n                    }\r\n                    subheader={this.getErrorTitle(context)}\r\n                    sx={{\r\n                      padding: '5px',\r\n                      flex: 1,\r\n                      '& .MuiCardHeader-action': {\r\n                        margin: 0,\r\n                      },\r\n                    }}\r\n                  />\r\n                </AccordionSummary>\r\n                <AccordionDetails sx={{ height: this.props.ContentHeight, padding: '8px 12px', overflow: 'auto' }}>\r\n                  {this.gernerateItems(context)}\r\n                </AccordionDetails>\r\n              </Accordion>\r\n            </Card>\r\n          )\r\n        }}\r\n      </UploadLayoutContext.Consumer>\r\n    )\r\n  }\r\n}\r\nconst AccordionSummary = styled((props: AccordionSummaryProps) => (\r\n  <MuiAccordionSummary expandIcon={<ExpandMore sx={{ fontSize: '0.9rem' }} />} {...props} />\r\n))(({ theme }) => ({\r\n  backgroundColor: theme.palette.mode === 'dark' ? 'rgba(255, 255, 255, .05)' : 'rgba(0, 0, 0, .03)',\r\n  flexDirection: 'row-reverse',\r\n  padding: ' 0 5px',\r\n  '& .MuiAccordionSummary-expandIconWrapper.Mui-expanded': {\r\n    // transform: 'rotate(90deg)',\r\n  },\r\n  '& .MuiAccordionSummary-content.Mui-expanded': {\r\n    // transform: 'rotate(90deg)',\r\n    margin: 0,\r\n  },\r\n  '& .MuiAccordionSummary-content': {\r\n    margin: 0,\r\n    display: 'flex',\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n}))\r\n\r\nconst AccordionDetails = styled(MuiAccordionDetails)(({ theme }) => ({\r\n  padding: theme.spacing(2),\r\n  borderTop: '1px solid rgba(0, 0, 0, .125)',\r\n}))\r\n"],"names":["UploadStatus","_Component","props","_this","_classCallCheck","_callSuper","_defineProperty","setState","expand","state","context","items","map","item","_jsx","ProgressItem","_objectSpread","disableDelete","onClose","onItemClose","onRetry","onItemRetry","Id","errors","getErrors","length","onRetryAll","e","preventDefault","stopPropagation","_jsxs","Box","sx","display","justifyContent","alignItems","children","Button","onClick","Typography","variant","_Fragment","_inherits","_createClass","key","value","componentWillUnmount","isUnmounted","componentDidMount","render","_this2","UploadLayoutContext","Consumer","Card","flex","background","margin","border","Accordion","expanded","onChange","expanChange","padding","AccordionSummary","expandIcon","ExpandMore","CardHeader","action","IconButton","onUploadClose","Close","title","fontWeight","getComplete","subheader","getErrorTitle","AccordionDetails","height","ContentHeight","overflow","gernerateItems","Component","styled","MuiAccordionSummary","fontSize","_ref","theme","backgroundColor","palette","mode","flexDirection","marginLeft","spacing","MuiAccordionDetails","_ref2","borderTop"],"mappings":"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"}