{"version":3,"file":"index.js","sources":["../../../src/Components/SwitchComponent/index.tsx"],"sourcesContent":["import React, { Component, ComponentType, FC } from 'react'\r\nimport { ModelBase } from 'partner-local-lib/helper'\r\nimport { RoleKeyExternalSite, RoleKeyInternalSite } from '../Helper/RoleKey'\r\nimport { authService } from 'partner-oidc-auth'\r\n\r\ntype RoleKey = RoleKeyExternalSite | RoleKeyInternalSite\r\ntype MapComponent = {\r\n  [key in RoleKey]?: ComponentType<any> | React.ReactElement<unknown, string | React.JSXElementConstructor<any>>\r\n}\r\n\r\n// function isComponentType(component: any): component is React.ComponentType {\r\n//   return typeof component === 'function'\r\n// }\r\n\r\ninterface SwitchComponentProps {\r\n  MapComponent: MapComponent\r\n}\r\ninterface SwitchComponentState {\r\n  roles: string[]\r\n}\r\n\r\nexport default class SwitchComponent extends Component<SwitchComponentProps, SwitchComponentState> {\r\n  constructor(props: any) {\r\n    super(props)\r\n    this.state = {\r\n      roles: [],\r\n    }\r\n  }\r\n  _isMounted = true\r\n  componentDidMount(): void {\r\n    authService.getRoles().then((roles) => {\r\n      if (this._isMounted) {\r\n        this.setState({ roles: roles ?? [] })\r\n      }\r\n    })\r\n  }\r\n  componentWillUnmount(): void {\r\n    this._isMounted = false\r\n  }\r\n  getComponent = () => {\r\n    const { MapComponent } = this.props\r\n    const roles = this.state.roles\r\n    const role = Object.keys(MapComponent).find((x) => roles?.some((y) => y === x)) ?? ''\r\n    return MapComponent[role as keyof Extract<MapComponent, ModelBase>]\r\n  }\r\n  render = () => {\r\n    const { MapComponent, ...other } = this.props\r\n    const ComponentSub = this.getComponent() ?? Div\r\n    // return <Component {...other} />\r\n    if (React.isValidElement(ComponentSub)) {\r\n      // component is a JSX element\r\n      return ComponentSub\r\n    } else {\r\n      // component is a ComponentType\r\n      return <ComponentSub {...other} />\r\n    }\r\n  }\r\n}\r\nconst Div: FC = (props) => <div>{props.children}</div>\r\n"],"names":["SwitchComponent","_Component","props","_this","_classCallCheck","_callSuper","_defineProperty","_Object$keys$find","MapComponent","roles","state","role","Object","keys","find","x","some","y","_this$getComponent","_this$props","other","_objectWithoutProperties","_excluded","ComponentSub","getComponent","Div","React","isValidElement","_jsx","_objectSpread","_inherits","_createClass","key","value","componentDidMount","_this2","authService","getRoles","then","_isMounted","setState","componentWillUnmount","Component","children"],"mappings":"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"}