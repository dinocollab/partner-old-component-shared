{"version":3,"file":"index.js","sources":["../../../src/Components/SkeletonService/index.tsx"],"sourcesContent":["import React, { ComponentType, FC, useRef, useState, useEffect, FunctionComponent } from 'react'\r\nimport { AuthorizeRouteContext } from 'partner-oidc-auth-ui'\r\ninterface IOption<IData> {\r\n  action: (param?: any, abort?: AbortSignal) => Promise<IData | undefined>\r\n}\r\ninterface IExtenData<IData> {\r\n  data: IData\r\n}\r\nexport interface IParamSkeleton {\r\n  param?: any\r\n  extract?: any\r\n  onResult?: (data?: any) => void\r\n}\r\nexport const SkeletonServiceCreate = function <Tprop, IData>(option: IOption<IData>) {\r\n  return (WrappedComponent: ComponentType<Tprop>) => {\r\n    const hocComponent: FC<Tprop & IExtenData<IData> & IParamSkeleton> = ({ ...props }) => {\r\n      const [data, setData] = useState<IData | undefined>()\r\n      const isMounted = useRef(false)\r\n      const tokenSource = useRef<AbortController>(new AbortController())\r\n      useEffect(() => {\r\n        isMounted.current = true\r\n        setData(undefined)\r\n        option.action({ ...(props.param ?? {}) }, tokenSource.current.signal).then((data) => {\r\n          if (isMounted.current) {\r\n            setData(data)\r\n          }\r\n          props.onResult && props.onResult(data)\r\n        })\r\n        return () => {\r\n          isMounted.current = false\r\n          tokenSource.current.abort()\r\n        }\r\n      }, [props.extract])\r\n      useEffect(() => {}, [props.param])\r\n      return <WrappedComponent {...props} data={data} IsLoading={!data} />\r\n    }\r\n    return hocComponent as FunctionComponent<Omit<Tprop & IParamSkeleton, keyof { data: any; IsLoading: any }>>\r\n  }\r\n}\r\ninterface IRoleViewProps {\r\n  Role: string[]\r\n}\r\nexport const RoleView: FC<IRoleViewProps> = (props) => {\r\n  const mapRole = new Set(props.Role)\r\n  const IsShow = (roles: string[]) => roles.some((x) => mapRole.has(x))\r\n  return (\r\n    <AuthorizeRouteContext.Consumer>\r\n      {({ state }) => {\r\n        return IsShow(state.roles ?? []) ? props.children : <></>\r\n      }}\r\n    </AuthorizeRouteContext.Consumer>\r\n  )\r\n}\r\n"],"names":["SkeletonServiceCreate","option","WrappedComponent","hocComponent","_ref","props","_extends","_objectDestructuringEmpty","_useState","useState","_useState2","_slicedToArray","data","setData","isMounted","useRef","tokenSource","AbortController","useEffect","_props$param","current","undefined","action","_objectSpread","param","signal","then","onResult","abort","extract","_jsx","IsLoading","RoleView","mapRole","Set","Role","IsShow","roles","some","x","has","AuthorizeRouteContext","Consumer","children","_ref2","_state$roles","state"],"mappings":"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"}