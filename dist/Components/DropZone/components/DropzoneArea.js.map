{"version":3,"file":"DropzoneArea.js","sources":["../../../../src/Components/DropZone/components/DropzoneArea.jsx"],"sourcesContent":["import PropTypes from \"prop-types\";\r\nimport * as React from \"react\";\r\n\r\nimport { createFileFromUrl, readFile } from \"../helpers\";\r\n\r\nimport DropzoneAreaBase from \"./DropzoneAreaBase\";\r\n\r\nconst splitDropzoneAreaProps = (props) => {\r\n  const {\r\n    clearOnUnmount,\r\n    initialFiles,\r\n    onChange,\r\n    onDelete,\r\n    ...dropzoneAreaProps\r\n  } = props;\r\n  return [\r\n    { clearOnUnmount, initialFiles, onChange, onDelete },\r\n    dropzoneAreaProps,\r\n  ];\r\n};\r\n\r\n/**\r\n * This components creates an uncontrolled Material-UI Dropzone, with previews and snackbar notifications.\r\n *\r\n * It supports all props of `DropzoneAreaBase` but keeps the files state internally.\r\n *\r\n * **Note** To listen to file changes use `onChange` event handler and notice that `onDelete` returns a `File` instance instead of `FileObject`.\r\n */\r\nclass DropzoneArea extends React.PureComponent {\r\n  state = {\r\n    fileObjects: [],\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.loadInitialFiles();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { clearOnUnmount } = this.props;\r\n\r\n    if (clearOnUnmount) {\r\n      this.setState(\r\n        {\r\n          fileObjects: [],\r\n        },\r\n        this.notifyFileChange\r\n      );\r\n    }\r\n  }\r\n\r\n  notifyFileChange = () => {\r\n    const { onChange } = this.props;\r\n    const { fileObjects } = this.state;\r\n\r\n    if (onChange) {\r\n      onChange(fileObjects.map((fileObject) => fileObject.file));\r\n    }\r\n  };\r\n\r\n  loadInitialFiles = async () => {\r\n    const { initialFiles } = this.props;\r\n    try {\r\n      const fileObjs = await Promise.all(\r\n        initialFiles.map(async (initialFile) => {\r\n          let file;\r\n          if (typeof initialFile === \"string\") {\r\n            file = await createFileFromUrl(initialFile);\r\n          } else {\r\n            file = initialFile;\r\n          }\r\n          const data = await readFile(file);\r\n\r\n          return {\r\n            file,\r\n            data,\r\n          };\r\n        })\r\n      );\r\n\r\n      this.setState(\r\n        (state) => ({\r\n          fileObjects: [].concat(state.fileObjects, fileObjs),\r\n        }),\r\n        this.notifyFileChange\r\n      );\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  addFiles = async (newFileObjects) => {\r\n    const { filesLimit } = this.props;\r\n    // Update component state\r\n    this.setState((state) => {\r\n      // Handle a single file\r\n      if (filesLimit <= 1) {\r\n        return {\r\n          fileObjects: [].concat(newFileObjects[0]),\r\n        };\r\n      }\r\n\r\n      // Handle multiple files\r\n      return {\r\n        fileObjects: [].concat(state.fileObjects, newFileObjects),\r\n      };\r\n    }, this.notifyFileChange);\r\n  };\r\n\r\n  deleteFile = (removedFileObj, removedFileObjIdx) => {\r\n    global.event.stopPropagation();\r\n\r\n    const { onDelete } = this.props;\r\n    const { fileObjects } = this.state;\r\n\r\n    // Calculate remaining fileObjects array\r\n    const remainingFileObjs = fileObjects.filter((fileObject, i) => {\r\n      return i !== removedFileObjIdx;\r\n    });\r\n\r\n    // Notify removed file\r\n    if (onDelete) {\r\n      onDelete(removedFileObj.file);\r\n    }\r\n\r\n    // Update local state\r\n    this.setState(\r\n      {\r\n        fileObjects: remainingFileObjs,\r\n      },\r\n      this.notifyFileChange\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const [, dropzoneAreaProps] = splitDropzoneAreaProps(this.props);\r\n    const { fileObjects } = this.state;\r\n\r\n    return (\r\n      <DropzoneAreaBase\r\n        {...dropzoneAreaProps}\r\n        fileObjects={fileObjects}\r\n        onAdd={this.addFiles}\r\n        onDelete={this.deleteFile}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nDropzoneArea.defaultProps = {\r\n  clearOnUnmount: true,\r\n  filesLimit: 3,\r\n  initialFiles: [],\r\n};\r\n\r\nDropzoneArea.propTypes = {\r\n  ...DropzoneAreaBase.propTypes,\r\n  /** Clear uploaded files when component is unmounted. */\r\n  clearOnUnmount: PropTypes.bool,\r\n  /** List containing File objects or URL strings.<br/>\r\n   * **Note:** Please take care of CORS.\r\n   */\r\n  initialFiles: PropTypes.arrayOf(\r\n    PropTypes.oneOfType([PropTypes.string, PropTypes.any])\r\n  ),\r\n  /** Maximum number of files that can be loaded into the dropzone. */\r\n  filesLimit: PropTypes.number,\r\n  /**\r\n   * Fired when the files inside dropzone change.\r\n   *\r\n   * @param {File[]} loadedFiles All the files currently loaded into the dropzone.\r\n   */\r\n  onChange: PropTypes.func,\r\n  /**\r\n   * Fired when a file is deleted from the previews panel.\r\n   *\r\n   * @param {File} deletedFile The file that was removed.\r\n   */\r\n  onDelete: PropTypes.func,\r\n};\r\n\r\nexport default DropzoneArea;\r\n"],"names":["splitDropzoneAreaProps","props","clearOnUnmount","initialFiles","onChange","onDelete","dropzoneAreaProps","_objectWithoutProperties","_excluded","DropzoneArea","_React$PureComponent","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_callSuper","concat","_defineProperty","fileObjects","state","map","fileObject","file","_asyncToGenerator","_regenerator","m","_callee2","fileObjs","_t","w","_context2","n","p","Promise","all","_ref2","_callee","initialFile","data","_context","createFileFromUrl","v","readFile","a","_x","apply","setState","notifyFileChange","console","log","_ref3","_callee3","newFileObjects","filesLimit","_context3","_x2","removedFileObj","removedFileObjIdx","global","event","stopPropagation","remainingFileObjs","filter","i","_inherits","_createClass","key","value","componentDidMount","loadInitialFiles","componentWillUnmount","render","_splitDropzoneAreaPro","_splitDropzoneAreaPro2","_slicedToArray","_jsx","DropzoneAreaBase","_objectSpread","onAdd","addFiles","deleteFile","React","PureComponent","defaultProps","propTypes","PropTypes","bool","arrayOf","oneOfType","string","any","number","func"],"mappings":"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"}